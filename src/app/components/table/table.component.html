<div class="table">
  <div class="table-header">
    <div class="table-header-inputWrapper">
      <input
        matInput
        (keyup)="applyFilter($event)"
        [(ngModel)]="filterObject.query"
        #ctrl="ngModel"
        placeholder="Pesquisar tabela"
        #input
      />

      <mat-icon>search</mat-icon>
    </div>

    <button [matMenuTriggerFor]="menu" class="table-header-moreFilters">
      <mat-icon>settings_input_component</mat-icon>
      <span>Filtrar por data</span>
    </button>

    <mat-menu #menu="matMenu">
      <mat-form-field appearance="outline">
        <mat-label>Insira um período</mat-label>
        <mat-date-range-input [rangePicker]="picker">
          <input
            matStartDate
            name="start"
            placeholder="Start date"
            [(ngModel)]="filterObject.startDate"
            (focus)="picker.open()"
          />
          <input
            matEndDate
            name="end"
            placeholder="End date"
            [(ngModel)]="filterObject.endDate"
            (focus)="picker.open()"
          />
        </mat-date-range-input>
        <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
      </mat-form-field>

      <div id="filterButtons">
        <button (click)="refreshTable()">Resetar Filtro</button>
        <button (click)="filterTableByDate()">Aplicar Filtro</button>
      </div>
    </mat-menu>

    <mat-paginator
      [pageSizeOptions]="[5, 10, 25, 100]"
      aria-label="Select page of users"
    ></mat-paginator>
  </div>

  <div class="mat-elevation-z0">
    <div class="loadingSpinner" *ngIf="isLoading">
      <mat-progress-spinner color="#007dfe" mode="indeterminate">
      </mat-progress-spinner>
    </div>
    <div [hidden]="isLoading">
      <table mat-table [dataSource]="dataSource" matSort>
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Usuário</th>
          <td mat-cell *matCellDef="let row">
            <div id="userWrapper">
              <span>{{ row.name }}</span>
              <span class="secondaryText">@{{ row.username }}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Título</th>
          <td mat-cell *matCellDef="let row">{{ row.title }}</td>
        </ng-container>

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Data</th>
          <td mat-cell *matCellDef="let row">
            <div id="dateWrapper">
              <span>{{ getDate(row.date) }}</span>
              <span class="secondaryText">{{ getTime(row.date) }}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="value">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Valor</th>
          <td mat-cell *matCellDef="let row">
            {{ formatCurrency(row.value) }}
          </td>
        </ng-container>

        <ng-container matColumnDef="isPayed">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Pago</th>

          <td mat-cell *matCellDef="let row">
            {{ row.isPayed ? "Sim" : "Não" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let row">
            <div id="actionsWrapper">
              <mat-icon (click)="openDialog('Editar', row.id)">{{
                "edit"
              }}</mat-icon>
              <mat-icon (click)="openDialog('Excluir', row.id)">{{
                "highlight_off"
              }}</mat-icon>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
        <tr mat-row *matRowDef="let row; columns: getDisplayedColumns()"></tr>

        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">Nenhum valor encontrado.</td>
        </tr>
      </table>
    </div>
  </div>
</div>
